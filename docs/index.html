<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Rishka: Rishka SDK</title>
<link rel="icon" href="rishka-logo.ico" type="image/x-icon" />
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="rishka-logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">Rishka
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Rishka SDK </div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><ul><li class="level2"><a href="#autotoc_md0">How Does It Work?</a></li>
<li class="level2"><a href="#autotoc_md1">Installation</a><ul><li class="level3"><a href="#autotoc_md2">Rishka VM</a></li>
<li class="level3"><a href="#autotoc_md3">Compiling Examples</a><ul><li class="level4"><a href="#autotoc_md4">Using rishka-cc tool</a></li>
<li class="level4"><a href="#autotoc_md5">Manually Compiling</a></li>
</ul>
</li>
</ul>
</li>
<li class="level2"><a href="#autotoc_md6">Example</a></li>
<li class="level2"><a href="#autotoc_md7">Contributing</a></li>
<li class="level2"><a href="#autotoc_md8">License</a></li>
</ul>
</ul>
</div>
<div class="textblock"><div align="center"> <img src="rishka-logo.png" alt="" width="140" class="inline"/> </div><p><img src="https://github.com/nthnn/rishka/actions/workflows/arduino_ci.yml/badge.svg" alt="Arduino CI" style="pointer-events: none;" class="inline"/> <img src="https://github.com/nthnn/rishka/actions/workflows/arduino_lint.yml/badge.svg" alt="Arduino Lint" style="pointer-events: none;" class="inline"/> <img src="https://github.com/nthnn/rishka/actions/workflows/rust_ci.yml/badge.svg" alt="Rust Build CI" style="pointer-events: none;" class="inline"/> <img src="https://github.com/nthnn/rishka/actions/workflows/sdk_ci.yml/badge.svg" alt="SDK Build CI" style="pointer-events: none;" class="inline"/> <img src="https://img.shields.io/github/repo-size/nthnn/rishka?logo=git&amp;label=Repository%20Size" alt="GitHub repo size" class="inline"/></p>
<p>Rishka is a RISC-V virtual runtime in C/C++ made for ESP32-WROVER with PSRAM specifically developed as kernel for <a href="https://github.com/nthnn/Jessy-OS">Jessy OS</a>.</p>
<h2><a class="anchor" id="autotoc_md0"></a>
How Does It Work?</h2>
<p>The Rishka virtual runtime is a system designed to run special RISC-V binaries smoothly on ESP32-WROVER microcontroller units. Under the hood, the virtual machine serves as the main engine, while the kernel acts as its core component. The kernel handles system calls efficiently, providing a range of interfaces for accessing different system features and services.</p>
<div align="center"> <img src="rishka-flow.png" alt="" class="inline"/> </div><p>These include basic functions like managing files, as well as more complex tasks like controlling GPIO pins, attaching and detaching interrupts, and communication protocols such as <a class="el" href="class_i2_c.html" title="Class for handling I2C operations in Rishka applications.">I2C</a> and <a class="el" href="class_s_p_i.html" title="Class for handling SPI communication in Rishka applications.">SPI</a>. Additionally, the kernel manages system utilities specific to the Jessy OS, handling tasks like sub-process runtime and memory allocation.</p>
<h2><a class="anchor" id="autotoc_md1"></a>
Installation</h2>
<h3><a class="anchor" id="autotoc_md2"></a>
Rishka VM</h3>
<p>Rishka VM is a lightweight and efficient virtual runtime environment designed for RISC-V binaries on ESP32-WROVER microcontrollers. Follow these steps to integrate Rishka into your Arduino projects:</p>
<ol type="1">
<li>Clone Rishka to your Arduino libraries, by typing the command below:</li>
</ol>
<div class="fragment"><div class="line">cd ~/Arduino/libraries</div>
<div class="line">git clone --depth 1 https://github.com/nthnn/rishka.git</div>
</div><!-- fragment --><ol type="1">
<li>Open your Arduino IDE, then navigate to <code><a class="el" href="class_file.html" title="Class for handling file operations in Rishka applications.">File</a> &gt; Examples &gt; rishka</code> and select an example suitable for your project.</li>
<li>You're all set! Integrate Rishka into your project and start leveraging its capabilities.</li>
</ol>
<h3><a class="anchor" id="autotoc_md3"></a>
Compiling Examples</h3>
<h4><a class="anchor" id="autotoc_md4"></a>
Using rishka-cc tool</h4>
<p>To use <code>rishka-cc</code>, you can get it from the release page if available or compile it yourself by typing the following on your terminal. Just make sure you have installed Rust compiler and Cargo package manager on your system.</p>
<div class="fragment"><div class="line">cargo build --release</div>
</div><!-- fragment --><p>Alternatively, you can install the <code>rishka-cc</code> tool by typing the following below on your system terminal:</p>
<div class="fragment"><div class="line">sh -c &quot;$(curl -fsSL https://raw.githubusercontent.com/nthnn/rishka/main/support/install_rishka_cc.sh)&quot;</div>
</div><!-- fragment --><p>Before using <code>rishka-cc</code>, you must configure two (2) environment variables, as shown below.</p>
<div class="fragment"><div class="line">export RISHKA_LIBPATH=&lt;path to sdk library folder&gt;</div>
<div class="line">export RISHKA_SCRIPTS=&lt;path to scripts folder&gt;</div>
</div><!-- fragment --><p>The <code>RISHKA_LIBPATH</code> must be a folder where the <code><a class="el" href="librishka_8h.html" title="Main header file for the Rishka SDK.">librishka.h</a></code> header file is located, while the <code>RISHKA_SCRIPTS</code> should be a folder where both <code>launch.s</code> and the <code>link.ld</code> files are located. For example, assuming Rishka was moved to the libraries folder on Arduino IDE:</p>
<div class="fragment"><div class="line">export RISHKA_LIBPATH=/Arduino/libraries/rishka/sdk</div>
<div class="line">export RISHKA_SCRIPTS=/Arduino/libraries/rishka/scripts</div>
</div><!-- fragment --><p>If no problems occured and was configured as instructed, you can now seamlessly use the <code>rishka-cc</code>.</p>
<p><img src="assets/rishka-cc.png" alt="" width="90%" class="inline"/> </p>
<h4><a class="anchor" id="autotoc_md5"></a>
Manually Compiling</h4>
<p>To compile SDK examples provided with Rishka, follow these steps:</p>
<ol type="1">
<li>If you haven't already, install Qrepo by following the instructions available <a href="https://github.com/nthnn/Qrepo">here</a>.</li>
<li>Ensure you have the RISC-V64 GCC toolchain installed by running:</li>
</ol>
<div class="fragment"><div class="line">sudo apt install gcc-riscv64-unknown-elf</div>
</div><!-- fragment --><ol type="1">
<li>Open a terminal and navigate to the directory where you cloned the Rishka repository.</li>
<li>Use Qrepo to compile the examples by executing the following command:</li>
</ol>
<div class="fragment"><div class="line">qrepo run compile &lt;source-file&gt; &lt;output-name&gt;</div>
</div><!-- fragment --><p>Replace <code>&lt;source-file&gt;</code> with the path to the source file of the example you want to compile and <code>&lt;output-name&gt;</code> with the desired name for the output binary.</p>
<p>Examples:</p>
<div class="fragment"><div class="line">qrepo run compile examples/sdk/hello.cpp hello</div>
<div class="line"># This will output the binary file to dist/hello.bin</div>
</div><!-- fragment --><p>Now you have successfully compiled the example and can proceed with using the generated binary file.</p>
<h2><a class="anchor" id="autotoc_md6"></a>
Example</h2>
<p>This example demonstrates the usage of Rishka virtual machine on an ESP32-WROVER microcontroller. It initializes serial communication and SD card, waits for user input via serial port, loads the specified file into the Rishka VM, executes it, and then waits for the next input.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;rishka.h&gt;</span></div>
<div class="line"> </div>
<div class="line">rishka_virtual_machine vm;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> setup() {</div>
<div class="line">    <span class="comment">// Begin serial communication at 115200 baud rate</span></div>
<div class="line">    Serial.begin(115200);</div>
<div class="line">    <span class="comment">// Wait until serial connection is established</span></div>
<div class="line">    <span class="keywordflow">while</span>(!Serial);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Initialize SD card on pin 5</span></div>
<div class="line">    <span class="keywordflow">if</span>(!SD.begin(5)) {</div>
<div class="line">        <span class="comment">// If SD card initialization fails, </span></div>
<div class="line">        <span class="comment">// print error message and halt execution</span></div>
<div class="line">        Serial.println(<span class="stringliteral">&quot;Failed to initialize SD card.&quot;</span>);</div>
<div class="line">        <span class="keywordflow">while</span>(<span class="keyword">true</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span>(!psramInit()) {</div>
<div class="line">        <span class="comment">// If PSRAM initialization fails,</span></div>
<div class="line">        <span class="comment">// print error message and halt execution</span></div>
<div class="line">        Serial.println(<span class="stringliteral">&quot;Cannot initialize PSRAM.&quot;</span>);</div>
<div class="line">        <span class="keywordflow">while</span>(<span class="keyword">true</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Print prompt</span></div>
<div class="line">    Serial.print(<span class="stringliteral">&quot;&gt; &quot;</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> loop() {</div>
<div class="line">    <span class="comment">// Check if there is data available to read from serial port</span></div>
<div class="line">    <span class="keywordflow">if</span>(!Serial.available())</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Read input from serial port</span></div>
<div class="line">    String input = Serial.readString();</div>
<div class="line">    <span class="comment">// Echo input back to serial port</span></div>
<div class="line">    Serial.print(input);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Initialize Rishka virtual machine</span></div>
<div class="line">    rishka_vm_initialize(&amp;vm, &amp;Serial);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Attempt to load specified file into Rishka virtual machine</span></div>
<div class="line">    <span class="keywordflow">if</span>(!rishka_vm_loadfile(&amp;vm, input.c_str())) {</div>
<div class="line">        <span class="comment">// If loading file fails, print error message and return</span></div>
<div class="line">        Serial.println(<span class="stringliteral">&quot;Failed to load specified file: &quot;</span> + input);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Run loaded program on Rishka virtual machine</span></div>
<div class="line">    rishka_vm_run(&amp;vm, 0, NULL);</div>
<div class="line">    <span class="comment">// Reset Rishka virtual machine for next execution</span></div>
<div class="line">    rishka_vm_reset(&amp;vm);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Print prompt for next input</span></div>
<div class="line">    Serial.print(<span class="stringliteral">&quot;&gt; &quot;</span>);</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md7"></a>
Contributing</h2>
<p>Contributions to Ladivic are highly encouraged and appreciated! To contribute new features, bug fixes, or enhancements, please adhere to the following guidelines:</p>
<ol type="1">
<li>Fork the rishka repository.</li>
<li>Create a new branch for your changes: <code>git checkout -b feature-name</code>.</li>
<li>Implement your changes and commit them: <code>git commit -m "Added new feature"</code>.</li>
<li>Push your changes to the branch: <code>git push origin feature-name</code>.</li>
<li>Submit a pull request for review and inclusion.</li>
</ol>
<h2><a class="anchor" id="autotoc_md8"></a>
License</h2>
<p>Rishka is distributed under the GNU General Public License v3.0. For further details, refer to the [LICENSE](LICENSE) file.</p>
<div class="fragment"><div class="line">This program is free software: you can redistribute it and/or modify  </div>
<div class="line">it under the terms of the GNU General Public License as published by  </div>
<div class="line">the Free Software Foundation, version 3.</div>
<div class="line"> </div>
<div class="line">This program is distributed in the hope that it will be useful, but </div>
<div class="line">WITHOUT ANY WARRANTY; without even the implied warranty of </div>
<div class="line">MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU </div>
<div class="line">General Public License for more details.</div>
<div class="line"> </div>
<div class="line">You should have received a copy of the GNU General Public License </div>
<div class="line">along with this program. If not, see &lt;http://www.gnu.org/licenses/&gt;.</div>
</div><!-- fragment --> </div></div><!-- PageDoc -->
<a href="doxygen_crawl.html"/>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="nav-path" class="navpath">
    <ul>
      <li class="footer">Copyright 2024 - <a href="https://github.com/nthnn" target="_blank">Nathanne Isip</a></li>
    </ul>
</div>